"use strict";angular.module("fmf.widgets",["ngDialog","cloudFront"]),angular.module("fmf.directives",["fmf.widgets","cloudFront"]),angular.module("fmfWidgetApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngDialog","fmf.directives","FmfService","ajoslin.promise-tracker","cloudFront"]).run(["promiseTracker",function(a){a("ajaxAnimation",{minDuration:100,maxDuration:4e4}).on("start",function(){jQuery("#sizenfit-main #transparentMask").show(),jQuery("#sizenfit-main #loadingAnimation").show()}).on("done",function(){jQuery("#sizenfit-main #loadingAnimation").hide(),jQuery("#sizenfit-main #transparentMask").hide()})}]).config(["$httpProvider","DOMAIN",function(a,b){a.defaults.useXDomain=!0,a.interceptors.push(["$q",function(a){return{request:function(a){return a.url.indexOf("/api")>=0&&(a.url=b.host+a.url),a}}}]),delete a.defaults.headers.common["X-Requested-With"]}]).config(["ngDialogProvider",function(a){a.setDefaults({className:"ngdialog-theme-plain",plain:!1,showClose:!0,closeByDocument:!0,closeByNavigation:!0,closeByEscape:!0,appendTo:!1})}]).config(["$routeProvider","$sceDelegateProvider",function(a,b){b.resourceUrlWhitelist(["**"])}]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"/fmfWidgetApp/views/main.html",controller:"MainCtrl"}).when("/kurta",{templateUrl:"/fmfWidgetApp/views/kurta.html",controller:"MainCtrl"}).when("/shirt",{templateUrl:"/fmfWidgetApp/views/shirt.html",controller:"MainCtrl"}).when("/blazers",{templateUrl:"/fmfWidgetApp/views/blazer.html",controller:"MainCtrl"}).when("/casualPant",{templateUrl:"/fmfWidgetApp/views/casual.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("cloudFront",[]).constant("AWS_CLOUD",{name:"AWS_WIDGET_IMAGES_CLOUD_FRONT_URL",url:"http://d1giea3dozdtkq.cloudfront.net/"}).constant("OAUTH",{google:{token:"1000407158739-lg9s109d8fqemg35cdq17kg6rt3vol7p.apps.googleusercontent.com"},facebook:{token:"1451546755158747"},twitter:{token:"lEK0xsLiCaJbrqN7GqY7ci4iX"}}).constant("DOMAIN",{name:"www.sizenfit.com",host:"https://fit.furniture",addConstant:""}),angular.module("fmfWidgetApp").controller("MainCtrl",["$resource","$rootScope","$scope","$routeParams","FmfService","ngDialog","$timeout","$http",function(a,b,c,d,e,f){function g(){console.log("main ctrl init...")}g(),c.shirtFilteredProductList=[{productidentifierid:5,entdomainid:23,entdomain:"www.sizenfit.com",productcode:"QCP-D",productname:"Women Shirt",entproductid:34,productbrand:"Wrangler",productstyle:"Punk",fitscore:null,producturl:"http://www.sizenfit.com:8080/fmfApp/#/products/Women/Shirt",productimageurl:"http://dummyWebsite.com/132906ad-37a0-4c4a-899a-c60edd5561d0-1277657-028138519.jpeg",productprice:599,collectionid:null,collectionname:null},{productidentifierid:12,entdomainid:18,entdomain:"www.snf.com",productcode:"IdenStyle1S11",productname:"Mens Shirt",entproductid:16,productbrand:"somee",productstyle:"slasd",fitscore:0,producturl:"http://www.snf.com:8080/fmfApp/#/products/Men/Blazer",productimageurl:"9da0361f-b108-45e0-a30c-d08f8e43324c-1277657-028138519.jpeg",productprice:399,collectionid:9,collectionname:"Mad"}],c.jeansFilteredProductList=[{producturl:"http://google.com/#/products/Men/JEANS-DENIMS",productidentifierid:497,entdomainid:70,entdomain:"google.com",productcode:"B00XA0G9K2",productname:"Calvin Klein Men's Regular Jeans",entproductid:2487,productbrand:"CALVIN KLEIN",productstyle:"Regular",fitscore:null,cdnenabled:!0,productimageurl:"f4db90bf-378c-4abf-9f38-5a31493a1692-6a6c1960-abac-4b09-8475-09b23a7f0df4-81AXF4glZaL._UL1500_.jpg",productprice:"6599.00",collectionid:null,collectionname:null},{productidentifierid:4,entdomainid:18,entdomain:"www.snf.com",productcode:"AL009MA85KVYINDFAS",productname:"Mens Levis Soparano Styled",entproductid:16,productbrand:"Levis",productstyle:"Soprano",fitscore:0,producturl:"http://www.snf.com:8080/fmfApp/#/products/Men/Jeans",productimageurl:"http://img6a.flixcart.com/www/promos/new/20150326-174933-jack.jpg",productprice:"399",collectionid:9,collectionname:"Mad"},{productidentifierid:7,entdomainid:18,entdomain:"www.snf.com",productcode:"SDL742172355",productname:"Women Jeans",entproductid:20,productbrand:"Levis",productstyle:"Soprano",fitscore:0,producturl:"http://www.snf.com:8080/fmfApp/#/products/Men/Jeans",productimageurl:"http://img5a.flixcart.com/www/promos/new/20150326-174933-roadster.jpg",productprice:"699",collectionid:9,collectionname:"Mad"},{productidentifierid:8,entdomainid:23,entdomain:"www.snf.com",productcode:"LevSlim101S",productname:"Men levis super tight",entproductid:28,productbrand:"Wrangler",productstyle:"TightFit",fitscore:0,producturl:"http://www.sizenfit.com:8080/fmfApp/#/products/Men/Jeans",productimageurl:"http://img6a.flixcart.com/www/promos/new/20150326-174933-levis.jpg",productprice:"399",collectionid:null,collectionname:null}],c.oneProduct={productidentifierid:4,entdomainid:18,entdomain:"www.snf.com",productcode:"ACR304",productname:"Feels like Heaven",entproductid:16,productbrand:"Levis",productstyle:"Soprano",fitscore:0,producturl:"http://www.snf.com:8080/fmfApp/#/products/Men/Jeans",productimageurl:"9da0361f-b108-45e0-a30c-d08f8e43324c-1277657-028138519.jpeg",productprice:399,collectionid:9,collectionname:"Mad"},c.blazerFilteredProductList=[{productidentifierid:11,entdomainid:18,entdomain:"www.snf.com",productcode:"BBRSAUETNN3967",productname:"Blazer",entproductid:16,productbrand:"Levis",productstyle:"Soprano",fitscore:0,producturl:"http://www.snf.com:8080/fmfApp/#/products/Men/Blazer",productimageurl:"9da0361f-b108-45e0-a30c-d08f8e43324c-1277657-028138519.jpeg",productprice:399,collectionid:9,collectionname:"Mad"}],c.casualFilteredProductList=[{productidentifierid:12,entdomainid:18,entdomain:"www.snf.com",productcode:"CasPants101S",productname:"CasualPant",entproductid:16,productbrand:"mufti",productstyle:"casual1",fitscore:0,producturl:"http://www.snf.com:8080/fmfApp/#/products/Men/Blazer",productimageurl:"9da0361f-b108-45e0-a30c-d08f8e43324c-1277657-028138519.jpeg",productprice:399,collectionid:9,collectionname:"Mad"},{productidentifierid:12,entdomainid:18,entdomain:"www.snf.com",productcode:"CasPants101S",productname:"CasualPant",entproductid:16,productbrand:"mufti",productstyle:"casual1",fitscore:0,producturl:"http://www.snf.com:8080/fmfApp/#/products/Men/Blazer",productimageurl:"9da0361f-b108-45e0-a30c-d08f8e43324c-1277657-028138519.jpeg",productprice:399,collectionid:9,collectionname:"Mad"}],c.openMe=function(){alert(),console.log("in broadcast msg"),c.$broadcast("openDialog",c.oneProduct)},c.$on("openSignIn",function(a,b){console.log(b)}),c.change=function(a,b){c.$broadcast("changeSize",a,b),console.log("Msg broadcast"),console.log("size:",a),console.log("Product Code:",b)},c.egoSort=function(a){return console.log("inside egoSort"),"Can't find Brand"==a?-1:a}}]),angular.module("FmfService",["ngResource","ngRoute","ngCookies"]).factory("FmfService",["$http","$q","$location","$rootScope","$resource","$cookieStore","AWS_CLOUD","DOMAIN",function(a,b,c,d,e,f,g,h){g.url;return d.snf={},d.snf.dataCache={},d.snf.widgetCache={},d.snf.productCriteriaCache=null,d.$on("changeProfile",function(a,b){var c=f.get("fmf.userData");c.profileName=b.profileName,f.put("fmf.userData",c),d.snf.dataCache.profileName=b.profileName,console.log("Profile changed :"+b.profileName)}),{addUser:function(b,c){return console.log("addUser input : "+JSON.stringify(b)),console.log("addUser : "+JSON.stringify(c)),a({method:"POST",url:h.addConstant+"/api/fitting/addUser",data:b,timeout:6e4,tracker:"ajaxAnimation"})},getData:function(a){if(d.dataInitialized){var b={},e=f.get("fmf.userData");return d.snf.dataCache.signedIn=e.signedIn,b.user=d.snf.dataCache,b.productCode=a,b.widget=d.snf.widgetCache[a],b}console.log("after map:",a);var g=f.get("fmf.userData");console.log("userCookie:"+JSON.stringify(g));var h="",i="",j="",k=c.host();if(_.isUndefined(g)){console.log("Cookie data not defined!");var l=(new Date).getTime();console.log("dateVal"+l),i="snfuser"+l+"@device.com",console.log("Setting user name: "+i);var e={userName:i};f.put("fmf.userData",e);var m={loginAuthId:i,loginName:i,loginAuthType:4,websiteUrl:k,oAuthLoginId:j};this.addUser(m,i).success(function(a,b){console.log("data: "+JSON.stringify(a)+"  ;status: "+b),"success"==a.status?(d.snf.dataCache.userName=i,d.snf.dataCache.oAuthLoginId=i,console.log("updated cookie userName :"+i),d.$broadcast("userCreatedWidget",m)):(d.error=!0,d.errorMessages=a?a.errors:"Unable to initialize")}).error(function(a,b){console.log("error function: data: user not created"+a+"  ;status: "+b),d.error=!0,d.errorMessages=a?a.errors:"Unable to initialize"})}else console.log("Cookie data: "+JSON.stringify(g)+" ; profileName: "+g.profileName),h=g.profileName,i=g.userName,j=g.oAuthLoginId;d.snf.dataCache={website:k,userName:i,profileName:h,oAuthLoginId:"",signedIn:"device"},d.dataInitialized=!0;var b={};return b.user=d.snf.dataCache,a&&(b.productCode=a,b.widget={}),b},updateData:function(a,b){if((_.isNull(d.snf.widgetCache)||_.isUndefined(d.snf.widgetCache))&&(d.widgetCache={}),(_.isNull(d.snf.dataCache)||_.isUndefined(d.snf.dataCache))&&this.getData(b),!_.isNull(a.profileName)&&!_.isUndefined(a.profileName)&&!_.isEmpty(a.profileName)){var c=f.get("fmf.userData"),e={profileName:a.profileName};return e=_.extend(c,e),console.log(e),f.put("fmf.userData",e),void(d.snf.dataCache=_.extend(d.snf.dataCache,a))}d.snf.widgetCache[b]=a},updateUserData:function(a,b){var c=f.get("fmf.userData"),e={profileName:a.loginName,signedIn:b};c.userName=a.loginName,console.log("updateuser data:"+c.userName),e=_.extend(c,e),f.put("fmf.userData",e),d.snf.dataCache=_.extend(d.snf.dataCache,a),d.snf.dataCache.userName=a.loginName,d.snf.dataCache.oAuthLoginId=a.loginName,d.snf.dataCache.signedIn=b,console.log("updated user cookie :"+JSON.stringify(f.get("fmf.userData")))},updateWidgetData:function(a,b,c){if(a==this.statusConstants().LINKDISPLAYED){var e=d.snf.widgetCache[c];e.widgetDisplayStatus=a,e.productRatingDetails={},e.bestFit={},_.isUndefined(b)||_.isNull(b)||(e.enterpriseProductType=b.current.productType,e.enterpriseProfileType=b.current.profileType),d.snf.widgetCache[c]=e}else jQuery.each(d.snf.widgetCache,function(d,e){if(e.productCode==c&&(e.widgetDisplayStatus=a,e.productRatingDetails=b,e.bestFit=null,e.fullDetails=b.scoreDetails,!_.isNull(b.scoreDetails)&&!_.isUndefined(b.scoreDetails))){for(var f=b.scoreDetails[0].ratingText,g=0,h=b.scoreDetails[0].overallFitScore,i=0;i<b.scoreDetails.length;i++)b.scoreDetails[i].overallFitScore>h&&(h=b.scoreDetails[i].overallFitScore,g=i,f=b.scoreDetails[i].ratingText);e.bestFit={index:g,ratingScore:h,size:b.scoreDetails[g].productSize,ratingText:f}}})},saveWidgetSelection:function(a,b,c){var e={profileType:a,productType:b};d.snf.widgetCache[c].widgetSelectingData=e},getWidgetSelection:function(a){return d.snf.widgetCache[a].widgetSelectingData},getWidgetStatus:function(b,d,e,f,g,i,j,k){var l=this.getData(b),m={productCode:b,website:l.user.website,userName:l.user.userName,profileName:l.user.profileName,details:d,productImageUrl:e,productUrl:c.absUrl(),productPrice:f,productDescription:g,enterpriseCurrency:i,productCartSize:j};return console.log("data rootdata:"+JSON.stringify(m)),a({method:"GET",data:m,url:h.addConstant+"/api/fitting/widgetDisplay",params:m,timeout:6e4,tracker:"ajaxAnimation"})},getProductTypes:function(b,c,d){return a({method:"GET",params:{productType:b,profileType:c},url:h.addConstant+"/api/fitting/getProductTypes"})},getBrandStyles:function(b,d,e,f){if(!_.isUndefined(d)&&!_.isEmpty(d)){var g={profileType:b,clothingType:d,enterpriseDomain:c.host()};return a({method:"GET",data:g,url:h.addConstant+"/api/fitting/getBrandStyles",params:g})}},getHeightWeight:function(b){var c=b;return c.userName=d.snf.dataCache.userName,console.log("saving getHeightWeight sample details: "+JSON.stringify(c)),a({method:"POST",url:h.addConstant+"/api/fitting/saveHeightWeightSample",data:c,timeout:6e4,tracker:"ajaxAnimation"})},getBrandsForEnterprise:function(b){return console.log("inside getBrandsForEnterprise"+JSON.stringify(b)),a({method:"POST",data:b,url:h.addConstant+"/admin/api/admin/getBrandsForEnterprise",timeout:6e4,tracker:"ajaxAnimation"})},getUserProfiles:function(b){var c={};return c.userName=d.snf.dataCache.userName,console.log("data.userName:"+c.userName),a({method:"GET",data:c,url:h.addConstant+"/api/fitting/getUserProfiles",params:c})},saveFittingSample:function(b){var c=b;return c.userName=d.snf.dataCache.userName,console.log("saving fitting sample details: "+JSON.stringify(c)),a({method:"POST",url:h.addConstant+"/api/fitting/saveFittingSample",data:c,timeout:6e4,tracker:"ajaxAnimation"})},deleteFittingSample:function(b){var c=b;return c.userName=d.snf.dataCache.userName,console.log("deleting sample details: "+JSON.stringify(c)),a({method:"POST",url:h.addConstant+"/api/fitting/deleteFittingSample",data:c,timeout:6e4,tracker:"ajaxAnimation"})},getRatingDetails:function(b,c){return a({method:"POST",params:{userFittingId:b,productDetailId:c},url:h.addConstant+"/api/fitting/getRatingDetails",timeout:6e4,tracker:"ajaxAnimation"})},getRatingDetailValues:function(b,c,d){return a({method:"POST",data:{userFittingId:b,productDetailId:c,fitDetails:d},url:h.addConstant+"/api/fitting/getRatingDetailValues",timeout:6e4,tracker:"ajaxAnimation"})},getTechSpecList:function(b,c){return a({method:"GET",params:b,url:h.addConstant+"/admin/api/admin/getTechSpecList",timeout:6e4,tracker:"ajaxAnimation"})},getTechSpecDetail:function(b){var c={productIdentifierId:b};return console.log("data in tech:"+JSON.stringify(b)),a({method:"GET",params:c,url:h.addConstant+"/admin/api/admin/getTechSpecDetail",timeout:6e4,tracker:"ajaxAnimation"})},getProfileNameFromType:function(a){return"1"==a?"women":"2"==a?"men":"3"==a?"girl":"4"==a?"boy":""},statusConstants:function(){return(_.isUndefined(d.snf.statusConstants)||_.isEmpty(d.snf.statusConstants))&&(d.snf.statusConstants={LINKDISPLAYED:3,SUMMARYDISPLAYED:4,DETAILDISPLAYED:5}),d.snf.statusConstants},messageConstants:function(){return(_.isUndefined(d.snf.messageConstants)||_.isEmpty(d.snf.messageConstants))&&(d.snf.messageConstants={CUSTOMSAMPLE:"Custom Sample",NAME:"Name",PCM:"PROVIDE CUSTOM MEASUREMENT"}),d.snf.messageConstants},reloadWidgetsRatingData:function(a,b){a&&jQuery.each(d.snf.widgetCache,function(a,c){a!=b&&d.$apply(function(){d.$broadcast("refreshWidget",a,c)})})},changeProfile:function(a){var b=f.get("fmf.userData");b.profileName=a.profileName,f.put("fmf.userData",b),d.snf.dataCache.profileName=b.profileName,console.log(JSON.stringify(f.get("fmf.userData")))},updateUser:function(){var a=f.get("fmf.userData");d.snf.dataCache.userName=a.userName,d.snf.dataCache.profileName=a.profileName}}}]),angular.module("fmf.widgets").directive("fmfWidgetManager",["FmfService",function(a){return console.log("invoked"),{restrict:"AE",require:["fmfWidgetManager"],controllerAs:"vm",templateUrl:"https://rawgit.com/snfpratiksha/sizenfitmagentotry/master/fmfWidgetManager.html",scope:{productCode:"@",widgetDisplayStatus:"@",productImageUrl:"@",productDescription:"@",enterpriseCurrency:"@",productPrice:"@",productCartUrl:"@",productCartOption:"@",productCartSize:"@"},link:function(a,b,c,d){_.isUndefined(c.productPrice)&&(c.productPrice=null),_.isUndefined(c.productDescription)&&(c.productDescription=null),_.isUndefined(c.enterpriseCurrency)&&(c.enterpriseCurrency=null),_.isUndefined(c.productImageUrl)&&(c.productImageUrl=null),_.isUndefined(c.productCartUrl)&&(c.productCartUrl=null),_.isUndefined(c.productCartOption)&&(c.productCartOption=null),_.isUndefined(c.productCartSize)&&(c.productCartOption=null),c.productCartOption=[{optiontitle:"L",optionvalue:"2450279399448"}],c.productCartSize="XS,S,M,L",c.productCartUrl="http://13.228.251.36/checkout/cart/add/uenc/aHR0cDovLzEzLjIyOC4yNTEuMzYvd29tZW4vY2xvdGhpbmcvdG9wcy9ibGFjay10aWUtdXAtdG9wLmh0bWw,/product/16189/form_key/7YgfbLqBmzgLtz3X/";var e={productCode:a.productCode,productImageUrl:c.productImageUrl,productUrl:c.productUrl,productPrice:c.productPrice,productDescription:c.productDescription,enterpriseCurrency:"INR",productCartUrl:c.productCartUrl,productCartOption:c.productCartOption,productCartSize:c.productCartSize};console.log("productoption:"+c.productCartOption),console.log("fmfWidgetManager: link called, productCode: "+e.productCode+", productImageUrl: "+c.productImageUrl+" ,productUrl : "+window.location.href+", productPrice: "+e.productPrice+", productDescription: "+e.productDescription+", enterpriseCurrency:"+e.enterpriseCurrency+",productCartUrl:"+c.productCartUrl+",productCartOption:"+c.productCartOption+",productCartSize:"+c.productCartSize),d[0].initialize(e)},controller:["$scope","OAUTH",function(b,c){function d(d){console.log("OAuth data : "+JSON.stringify(c));var e={productCode:d.productCode,productImageUrl:d.productImageUrl,productPrice:d.productPrice,productDescription:d.productDescription,enterpriseCurrency:d.enterpriseCurrency,productCartUrl:d.productCartUrl,productCartOption:d.productCartOption,productCartSize:d.productCartSize};a.updateData(e,e.productCode),l.data=a.getData(e.productCode),l.optionsize=a.getData(e.productCartOption),l.cartUrl=a.getData(e.productCartUrl),console.log("vm.cartUrl",l.cartUrl);var f=l.data.productCode,g=l.optionsize.productCode,h=l.cartUrl.productCode;console.log("vm.optionsize",g,h),a.getWidgetStatus(l.data.productCode,0,l.data.widget.productImageUrl,l.data.widget.productPrice,l.data.widget.productDescription,l.data.widget.enterpriseCurrency,l.data.widget.productCartSize).success(function(c,d){"success"==c.status?(b.errorMessages=null,l.data.widgetDisplayStatus=c.data.widgetStatus.code,l.data.productRatingDetails=c.data.widgetStatus.data,"3"==l.data.widgetDisplayStatus?(l.data.enterpriseProductType=c.data.widgetStatus.data.current.productType,l.data.enterpriseProfileType=c.data.widgetStatus.data.current.profileType,a.saveWidgetSelection(l.data.enterpriseProfileType,l.data.enterpriseProductType,f)):"4"==l.data.widgetDisplayStatus||"5"==l.data.widgetDisplayStatus?(l.data.enterpriseProfileType=c.data.widgetStatus.data.sampleFitting.profileType,l.data.enterpriseProductType=c.data.widgetStatus.data.sampleFitting.productType,a.saveWidgetSelection(l.data.enterpriseProfileType,l.data.enterpriseProductType,f)):"1"==l.data.widgetDisplayStatus||l.data.widgetDisplayStatus,l.data.widget.productTypeFileName=l.data.widget.productImageUrl,a.updateWidgetData(c.data.widgetStatus.code,c.data.widgetStatus.data,f),l.data=a.getData(f)):(b.error=!0,b.errorMessages=c.errors)}).error(function(a,c){console.log("error function: data: "+a+"  ;status: "+c),b.error=!0,b.errorMessages=a?a.errors:"Unable to initialize"}),hello.init({facebook:c.facebook.token,google:c.google.token,twitter:c.twitter.token},{redirect_uri:"/fmfWidgetApp/views/redirect.html"})}function e(){return a.getData(l.data.productCode)}function f(){return a.getData(l.optionsize.productCode)}function g(){return a.getData(l.cartUrl.productCode)}function h(b){return a.updateData(b,l.data.productCode)}function i(){if("function"==typeof l.modifyDisplayMethod){var b=a.getData(l.data.productCode);console.log("fmfWidgetManager: modifyDisplay called: "+JSON.stringify(b)),l.modifyDisplayMethod(b)}}function j(){console.log("inside showchart");var b=a.getData(l.data.productCode);l.showDialogMethod1(b)}function k(a){l.showDialogMethod1=a}console.log("fmfWidgetManager: controller called");var l=this;l.data={},l.ngDialogOpened=!1,l.showSizechart=null;l.initialize=d,l.getData=e,l.updateData=h,l.modifyDisplay=i,l.showSizechart=j,l.respondToShowWithsize=k,l.getsize=f,l.getCartUrl=g,b.$on("ngDialog.opened",function(a,b){l.data.ngDialogOpened=!0}),b.$on("userLoggedIn",function(b,c){a.updateUser()})}]}}]),angular.module("fmf.widgets").directive("fmfWidgetDialog",["ngDialog","FmfService",function(a,b){return console.log("fmfWidgetDialog invoked"),{restrict:"AE",require:["^fmfWidgetManager","fmfWidgetDialog"],controllerAs:"vm",scope:{},templateUrl:"https://rawgit.com/snfpratiksha/sizenfitmagentotry/master/fmfWidgetDialog.html",link:function(a,b,c,d){console.log("fmfWidgetDialog: link called");var e=d[0],f=d[1];f.fmfManager=e,f.initialize()},controller:["$scope","$window","$rootScope","$location","AWS_CLOUD","DOMAIN","$interval","$timeout",function(c,d,e,f,g,h,j,k){function l(){G.data=G.fmfManager.getData(),G.optionSize=G.fmfManager.getsize(),G.getcartUrl=G.fmfManager.getCartUrl(),o(G.data.user.signedIn),v(),m(),n(),G.fmfManager.respondToShowWithsize(q)}function m(){var a=JSON.stringify(G.optionSize.productCode);A=JSON.parse(a),console.log("fmfData:"+JSON.stringify(A),A.length);for(var b=0;b<A.length;b++)jQuery.each(A[b],function(a,c){console.log("inside jquery",a,c),"optiontitle"==a&&(J[b]=c)});console.log("vm.dlgData.sizes:"+J)}function n(){B=G.getcartUrl.productCode;var a=C;console.log("productCartUrlfinal",a)}function o(a){"device"!=a&&(console.log("Signed in using :"+a),G.signedIN=a)}function p(){var a;console.log("fmfWidgetDialog: invoking getProductTypes...");var c;return G.data.widget.widgetDisplayStatus!=b.statusConstants().LINKDISPLAYED&&3!=G.data.widget.widgetDisplayStatus&&5!=G.data.widget.widgetDisplayStatus||(c=G.data.enterpriseProductType),b.getProductTypes(c,G.dlgData.profileType).success(function(a,d){if(console.log("fmfWidgetDialog: getProductTypes data: "+JSON.stringify(a)+"  ;status: "+d),"success"==a.status)if(G.dlgData.productTypes=a.data.productTypes,G.data.widget.widgetDisplayStatus==b.statusConstants().LINKDISPLAYED||3==G.data.widget.widgetDisplayStatus||5==G.data.widget.widgetDisplayStatus)for(var e=0;e<a.data.productTypes.length;e++)a.data.productTypes[e]==c&&(G.dlgData.selected.clothingType=a.data.productTypes[e]);else G.dlgData.selected.clothingType=G.dlgData.productTypes[0];else console.log("fmfWidgetDialog: getProductTypes error function: errors: "+a.errors)}).error(function(a,b){console.log("fmfWidgetDialog: getProductTypes error function: data: "+JSON.stringify(a)+" ;status: "+b)}),a}function q(d){G.data=d,console.log("vm.data"+JSON.stringify(G.data)),console.log("vm.data.widget.widgetDisplayStatus",G.data.widgetDisplayStatus),G.data.widget.widgetDisplayStatus!=b.statusConstants().LINKDISPLAYED&&G.data.widget.widgetDisplayStatus!=b.statusConstants().SUMMARYDISPLAYED&&G.data.widget.widgetDisplayStatus!=b.statusConstants().DETAILDISPLAYED||(G.data.currentStatus=b.getWidgetSelection(G.data.productCode),G.dlgData.profileType=G.data.currentStatus.profileType,G.dlgData.productImageUrl=G.data.widget.productImageUrl,console.log("fmfWidgetDialog : Current Product and Profile :"+G.data.currentStatus.productType+" "+G.data.currentStatus.profileType)),t(G.data.productCode,1,G.data.widget.productImageUrl,G.data.widget.productPrice,G.data.widget.productDescription,G.data.widget.enterpriseCurrency,G.data.widget.productCartSize),a.open({templateUrl:"https://rawgit.com/snfpratiksha/sizenfitmagentotry/master/fmfDialog.html",className:"ngdialog-theme-plain",showClose:!1,preCloseCallback:function(){if(console.log("default pre-close callback"),_.isUndefined(G.signedIN)&&G.sampleModified&&f.host()==h.name)return!1;x()},scope:c,controller:["$scope",function(c){function d(){var a=M;if(console.log("Yey yey oh yey:-"+a+O),0==O)console.log("Called Once"),O=1;else{console.log("Called Twice");document.getElementById(a);k(function(){console.log("inTimeout Fun"),scrollToptry(a)}),O=0,console.log("Resetting")}}function e(){var a=document.getElementById("snf5342-color"),b=document.getElementById("snf5342-widget-select-height-in"),c=document.getElementById("snf5342-widget-select-height"),d=document.getElementById("snf5342-widget-select-weight"),e=F/Math.pow(.0254*E,2);e<=10||e>=50?(a.style.color="red",b.style.color="red",c.style.color="red",d.style.color="red"):(a.style.color="#999",b.style.color="#999",c.style.color="#999",d.style.color="#999")}function g(){var a=document.getElementById("snf5342-widget-select-height-cm"),b=document.getElementById("snf5342-widget-select-weight"),c=Math.round(.01*E);console.log("convercm",c);var d=F/Math.pow(c,2);console.log("bmi:",d),d<=10||d>=50?(console.log("in bmi if:"),a.style.color="red",b.style.color="red"):(a.style.color="#999",b.style.color="#999")}function j(){var a=document.getElementById("snf5342-widget-select-weight-lb"),b=document.getElementById("snf5342-color"),c=document.getElementById("snf5342-widget-select-height-in"),d=document.getElementById("snf5342-widget-select-height"),e=Math.round(F/2.2);console.log("convercm",e);var f=e/Math.pow(.0254*E,2);console.log("bmi:",f),f<=10||f>=50?(console.log("in bmi if:"),c.style.color="red",b.style.color="red",a.style.color="red",d.style.color="red"):(b.style.color="#999",c.style.color="#999",d.style.color="#999",a.style.color="#999")}function l(){var a=document.getElementById("snf5342-widget-select-height-cm"),b=document.getElementById("snf5342-widget-select-weight-lb"),c=Math.round(.01*E),d=Math.round(F/2.2);console.log("convercm"+c,d);var e=d/Math.pow(c,2);console.log("bmi:",e),e<=10||e>=50?(console.log("in bmi if:"),a.style.color="red",b.style.color="red"):(a.style.color="#999",b.style.color="#999")}function m(){"2B"==G.dlgData.displayPanel&&(c.selectUom(heightUnitSelect.value),G.dlgData.uomProductCriteriah=heightUnitSelect.value,console.log("ht uom:",G.dlgData.uomProductCriteriah),"ft"==G.dlgData.uomProductCriteriah&&"kg"==G.dlgData.uomProductCriteriaw?(console.log("in kg and ft"),e()):"cm"==G.dlgData.uomProductCriteriah&&"kg"==G.dlgData.uomProductCriteriaw?(console.log("in kg and cm"),g()):"ft"==G.dlgData.uomProductCriteriah&&"lb"==G.dlgData.uomProductCriteriaw?(console.log("in lb and ft"),j()):l(),console.log("htvalue:"+G.dlgData.selected.htvalue),E=G.dlgData.selected.htvalue)}function n(){console.log("vm.dlgData.displayPanel",G.dlgData.displayPanel),"2B"==G.dlgData.displayPanel&&(console.log("inside updatewt"),c.selectUom(weightUnitSelect.value),G.dlgData.uomProductCriteriaw=weightUnitSelect.value,"ft"==G.dlgData.uomProductCriteriah&&"kg"==G.dlgData.uomProductCriteriaw?(console.log("in kg and ft"),e()):"cm"==G.dlgData.uomProductCriteriah&&"kg"==G.dlgData.uomProductCriteriaw?(console.log("in kg and cm"),g()):"ft"==G.dlgData.uomProductCriteriah&&"lb"==G.dlgData.uomProductCriteriaw?(console.log("in lb and ft"),j()):l(),console.log("wtvalue:"+G.dlgData.selected.wtvalue),F=G.dlgData.selected.wtvalue)}function o(){G.dlgData.ratingTab=!0,console.log("headbreak"),k(function(){G.dlgData.displayPanel=T,d()},2e3)}c.$watch("vm.data",function(a){console.log("fmf dlg: data changed: "+a.productCode)}),c.$watch("vm.data.widget.widgetDisplayStatus",function(a){console.log("fmf dlg: Got widgetDisplayStatus: "+a),"005"==a?(console.log("under 005",G.customDriven),G.customDriven?(console.log("customDriven"),G.dlgData.fitTab=!0,G.dlgData.displayPanel=P):(console.log("else customDriven"),console.log("tab:",G.dlgData.fitTab,G.dlgData.ratingTab,G.dlgData.displayPanel),G.dlgData.ratingTab=!0,"2B1"==G.dlgData.displayPanel||"2A1"==G.dlgData.displayPanel?G.dlgData.displayPanel=U:(console.log("tabnew:",G.dlgData.displayPanel,G.dlgData.ratingTab),G.dlgData.displayPanel=U))):(console.log("fmf dlg: Setting ratingTab to false",G.dlgData.fitTab),3==a?(console.log("inside data 3",G.dlgData.displayPanel),"2A"!=G.dlgData.displayPanel&&0!=G.dlgData.displayPanel||(G.dlgData.displayPanel=ba)):(console.log("inside data 3 else"),G.dlgData.fitTab=!0,G.dlgData.ratingTab=!1))}),c.$watch("vm.data.user.userProfiles",function(a){if(console.log("fmf dlg: Got userProfiles: "+JSON.stringify(a)),G.dlgData.filteredProfileList=[],G.selectedProfileIndex="",!_.isUndefined(a)&&a.length>0){console.log("in vm.data.user.userProfiles"),G.dlgData.selectedProfile={},G.dlgData.currentProfile={};for(var b=0;b<a.length;b++)G.data.user.profileName==a[b].profileName&&(G.dlgData.currentProfile=a[b]);_.isUndefined(G.dlgData.currentProfile.samples)||G.dlgData.profileType!=G.dlgData.currentProfile.samples[0].profileType?(G.dlgData.listProfile=G.dlgData.filteredProfileList[0],G.dlgData.selectedProfile=G.dlgData.filteredProfileList[0]):(G.dlgData.listProfile=G.dlgData.currentProfile,G.dlgData.selectedProfile=G.dlgData.currentProfile,console.log("is undefined selectedprofile"+JSON.stringify(G.dlgData.selectedProfile)))}else console.log("fmf dlg: Setting panel 1"),G.dlgData.displayPanel=ba,G.dlgData.fitTab=!0}),c.$watch("vm.dlgData.selected.clothingType",function(a){_.isUndefined(a)||_.isNull(a)||""==a||c.updateBrands()}),c.$watch("vm.dlgData.selected.brand",function(a){console.log("in seleted brand"),G.dlgData.profileType&&(console.log("in seleted brand in if"+a),_.isUndefined(a)||_.isNull(a)||(console.log("isUndefined"),c.updateBrands(),c.updateStyles())),disableButton()}),c.$on("editingSample",function(a,b){if(!_.isUndefined(b)&&!_.isNull(b))for(var c=0;c<G.dlgData.brands.length;c++)G.dlgData.brands[c].name==b.brandName&&(G.dlgData.selected.brand=G.dlgData.brands[c])}),c.$watch("vm.data.widget.productRatingDetails.sampleFitting",function(a){if(_.isUndefined(a)||G.data.widget.widgetDisplayStatus!=b.statusConstants().DETAILDISPLAYED&&G.data.widget.widgetDisplayStatus!=b.statusConstants().SUMMARYDISPLAYED)console.log("fmf dlg: Resetting data..."),G.data.sizes="",G.data.ratings="",G.data.measurements={},G.data.score="";else{console.log("fmf dlg: productRatingDetails.sampleFitting data changed: "+JSON.stringify(a)),G.data.measurementUnit=G.data.widget.productRatingDetails.sampleFitting.uom;var d,e=[],f={};if(!_.isUndefined(a)&&!_.isNull(a)){_.isUndefined(G.data.widget.productRatingDetails.sampleFitting.sampleName)||_.isNull(G.data.widget.productRatingDetails.sampleFitting.sampleName)?(d=G.data.user.profileName+" 's "+G.data.widget.productRatingDetails.sampleFitting.productType+" "+b.messageConstants().CUSTOMSAMPLE,f={sampleName:d,userFittingId:null,productDetailId:null,productType:G.data.widget.productRatingDetails.sampleFitting.productType},e.push(f)):(d=G.data.user.profileName+" 's "+G.data.widget.productRatingDetails.sampleFitting.sampleName,f={sampleName:d,userFittingId:null,productDetailId:null,productType:G.data.widget.productRatingDetails.sampleFitting.productType},e.push(f)),G.data.widget.productRatingDetails.similarSamples.length>0?(jQuery.each(G.data.widget.productRatingDetails.similarSamples,function(a,c){_.isUndefined(c.sampleName)||_.isNull(c.sampleName)?(c.sampleName=G.data.user.profileName+" 's "+c.productType+" "+b.messageConstants().CUSTOMSAMPLE,e.push(c)):(c.sampleName=G.data.user.profileName+" 's "+c.sampleName,e.push(c))}),G.data.comparedWithSamples=e):G.data.comparedWithSamples=e,G.dlgData.selected.comparedWithSamples=G.data.comparedWithSamples[0];for(var g=(G.data.widget.productRatingDetails.scoreDetails[0].ratingText,0),h=G.data.widget.productRatingDetails.scoreDetails[0].overallFitScore,i=0;i<G.data.widget.productRatingDetails.scoreDetails.length;i++)G.data.widget.productRatingDetails.scoreDetails[i].overallFitScore>h&&(h=G.data.widget.productRatingDetails.scoreDetails[i].overallFitScore,g=i);G.data.sizes=G.data.widget.productRatingDetails.scoreDetails[g].productSize,G.data.score=G.data.widget.productRatingDetails.scoreDetails[g].overallFitScore,G.data.ratings=G.data.widget.productRatingDetails.scoreDetails[g].ratingText,G.showCheck=g,c.changeSize(g),G.dlgData.showScoreDetails=!0}if(G.dlgData.selectedProfile)for(i=0;i<G.dlgData.selectedProfile.samples.length;i++)_.isUndefined(G.data.widget.productRatingDetails.sampleFitting)||G.dlgData.selectedProfile.samples[i].productType==G.data.widget.productRatingDetails.sampleFitting.productType&&(G.selectedProfileIndex=i);G.dlgData.fitTab=!1;var a=G.data.widget.productRatingDetails}}),console.log("scoredetail:"+G.data.widget.productRatingDetails.scoreDetails),c.$watch("vm.data.widget.productRatingDetails.scoreDetails",function(a){if(L+=1,a){for(var b=0,d=a[0].overallFitScore,e=0;e<a.length;e++)a[e].overallFitScore>d&&(d=a[e].overallFitScore,b=e);console.log("Testing 123:- "+b),c.changeSize(b),console.log("fitTab:"+G.dlgData.showScoreDetails,y)}if(console.log("In shape null command"),L>=2&&(11==G.dlgData.displayPanel||12==G.dlgData.displayPanel||13==G.dlgData.displayPanel)){G.data.scoredemo=10*G.data.score+50;var f=document.getElementById("snf5342-widget-canvas");f.setAttribute("data-percent",G.data.scoredemo),drowcircle(),G.dlgData.displayPanel=U,c.changeSize(b),o(),L=0}if(console.log("In shapeno not nul command:-"+G.dlgData.displayPanel+"  count:- "+L),13==G.dlgData.displayPanel&&1==L&&1==N){console.log("Gotcha"),G.data.scoredemo=10*G.data.score+50;var f=document.getElementById("snf5342-widget-canvas");f.setAttribute("data-percent",G.data.scoredemo),drowcircle(),G.dlgData.displayPanel=U,c.changeSize(b),o(),L=0}}),c.resetSelection=function(){G.dlgData.brandStyles={},G.dlgData.brandSizes={},G.dlgData.selected.criteria={},G.dlgData.selected.brandName="",G.dlgData.selected.style="",G.dlgData.selected.size="",G.dlgData.profileType=1,G.dlgData.c1Variables=[],G.customDriven=!1,G.updateMyProfile=0,G.fromEdit=!1,G.sampleModified=!1,G.signedIN=!1,G.dlgData.loginTab=!1,G.ratingTab=!1},c.updateBrands=function(){console.log("in update brands"),G.dlgData.selected.uom="In",G.dlgData.brandStyles={},G.dlgData.brandSizes={},G.dlgData.selected.style="",G.dlgData.selected.size="",G.dlgData.selected.clothingType&&r()},c.getCartUrlfinal=function(){var a=C;console.log("productCartUrlfinal",a),window.location=a},c.selectedsize=function(){c.selected=this.r.productSize,G.dlgData.selectedsize=c.selected,console.log(G.dlgData.selectedsize);var a=B.replace(/.$/,"?");console.log("str1:"+a);for(var b=0;b<A.length;b++)G.dlgData.selectedsize==A[b].optiontitle&&(D=A[b].optionvalue);console.log("optionvalue:",D),C=a.concat("super_attribute[134]=",D),console.log("productCartUrl:"+C)},c.event=function(a){console.log(a),c.vm.dlgData.selected.brand=a,myfun1()},c.getheightnew=function(){return console.log("In get height"),console.log("Height value:-"+G.dlgData.selected.htvalue),G.dlgData.selected.htvalue},c.getweightnew=function(){return console.log("In get weight"),console.log("Weight value:-"+G.dlgData.selected.wtvalue),G.dlgData.selected.wtvalue},c.update=function(a,b){console.log("In update"),"ft"==b?(console.log("Updating height in feet"),G.dlgData.selected.htvalue=a,E=a,G.dlgData.uomProductCriteriah="ft",console.log("height"+G.dlgData.selected.htvalue),m()):"kg"==b?(console.log("Updating weight in kg"),G.dlgData.selected.wtvalue=a,F=a,G.dlgData.uomProductCriteriaw="kg",console.log(G.dlgData.selected.wtvalue),n()):"lb"==b?(console.log("Updating weight in lb"),G.dlgData.selected.wtvalue=a,F=G.dlgData.selected.wtvalue,G.dlgData.uomProductCriteriaw="lb",console.log(G.dlgData.selected.wtvalue),n()):"cm"==b&&(console.log("Updating height in cm"),G.dlgData.selected.htvalue=a,E=G.dlgData.selected.htvalue,G.dlgData.uomProductCriteriah="cm",console.log(G.dlgData.selected.htvalue),m()),console.log("ENd")},c.updateclothingprf=function(){for(var a=0;a<3;a++)1==List3[a].checked&&(G.dlgData.selected.clothingpfr=List3[a].defaultValue);console.log("clothingpfr:"+G.dlgData.selected.clothingpfr),"Skin Tight"==G.dlgData.selected.clothingpfr&&(z=1),"Normal"==G.dlgData.selected.clothingpfr&&(z=2),"Bit Loose"==G.dlgData.selected.clothingpfr&&(z=3),console.log("fitno"+z)},c.updateshape=function(){console.log("vm.dlgData.selected.shape"+G.dlgData.selected.shape),"oval"==G.dlgData.selected.shape&&(y=1),"Rectangle"==G.dlgData.selected.shape&&(y=2),"Triangle"==G.dlgData.selected.shape&&(y=3),"Hour Glass"!=G.dlgData.selected.shape&&"Inverted Triangle"!=G.dlgData.selected.shape||(y=4),console.log("shapeno:"+y)},c.updateArray=function(){console.log("Complete db values"+H),updateStyles()},c.updateStyles=function(){var a=angular.element(document.getElementById("snf5342-widget-tab-btn-02"));a.attr("disabled",!1);var b;if(c.bgCol="#31859c",c.col="#fff",_.isUndefined(G.dlgData.selected.brand))console.log("Disbaling Button abc function"),a.attr("disabled",!0),c.bgCol="",c.col="#B5B5B5";else if(_.isNull(G.dlgData.selected.brand)||""==G.dlgData.selected.brand)console.log("Disbaling Button abc function"),a.attr("disabled",!0),c.bgCol="",c.col="#B5B5B5";else{console.log("vm.dlgData:"+JSON.stringify(G.dlgData.brands));var d=G.dlgData.brands.length;console.log("len",d);for(var e=0;e<d;e++){if(G.dlgData.selected.brand==G.dlgData.brands[e].name){a.attr("disabled",!1),c.bgCol="#31859c",c.col="#fff",b=!0;break}a.attr("disabled",!0),c.bgCol="",c.col="#B5B5B5",b=!1}}if(b){for(var e=0;e<H.data.brands.length;e++)H.data.brands[e].name==G.dlgData.selected.brand&&(console.log("Match Found"),I=H.data.brands[e]);console.log("dummyVar value"+JSON.stringify(I)),c.bnamechange=I.name.toLowerCase(),G.dlgData.selected.brandName=I.name,G.dlgData.brandStyles={},G.dlgData.brandSizes={},G.dlgData.selected.style=void 0,G.dlgData.selected.size="",G.dlgData.selected.brandName&&(console.log("inside brandstyle"),G.dlgData.brandStyles=$.map(I.styles,function(a){return a.style}),console.log("vm.dlgData.brandStyles:"+G.dlgData.brandStyles),G.dlgData.selected.style=I.styles[0].style,console.log("in style:"+G.dlgData.selected.style),c.updateSizes(),c.vm.dlgData.selected.style="",G.dlgData.brandStyles.length<2&&(G.dlgData.selected.style=I.styles[0].style,console.log("in style:"+G.dlgData.selected.style),c.updateSizes()));var f=0;if(G.dlgData.editingProfile){if(G.dlgData.editingsample.brandName==G.dlgData.selected.brand){G.dlgData.selected.style=G.dlgData.editingsample.style;for(var e=0;e<G.dlgData.brandStyles.length;e++)G.dlgData.selected.style==G.dlgData.brandStyles[e]&&(f=e)}else G.dlgData.selected.style=I.styles[0].style,f=0;c.updateSizes(),seimaChangeStyle(f)}}},c.updateSizes=function(){console.log("fmf dlg: Update sizes for style: "+JSON.stringify(G.dlgData.selected.style));var a=_.find(I.styles,function(a){return a.style==G.dlgData.selected.style});a&&(G.dlgData.brandSizes=a.sizes);var b=0;if(G.dlgData.editingProfile){if(G.dlgData.editingsample.brandName==G.dlgData.selected.brand){G.dlgData.selected.size=G.dlgData.editingsample.size;for(var c=0;c<G.dlgData.brandSizes.length;c++)if(G.dlgData.selected.size==G.dlgData.brandSizes[c]){b=c;break}}else G.dlgData.selected.size=G.dlgData.brandSizes[0],b=0;seimaChangeSize(b)}},c.profile=function(){console.log("in profile manager:",G.dlgData.selected.profileName),"Guest"==G.dlgData.selected.profileName?(console.log("guest hai"),G.dlgData.selected.profileName=""):console.log("guest nai hai")},c.secondpartbrand=function(){_.isUndefined(G.dlgData.selected.style)?(console.log("Setting undefined Style"),G.dlgData.selected.style=G.dlgData.brandStyles[0]):(_.isNull(G.dlgData.selected.style)||""==G.dlgData.selected.style)&&(console.log("Setting null Style"),G.dlgData.selected.style=G.dlgData.brandStyles[0]),console.log("Style:-"+G.dlgData.selected.style),_.isUndefined(G.dlgData.selected.size)?(console.log("Setting undefined Size"),G.dlgData.selected.size=G.dlgData.brandSizes[0]):(_.isNull(G.dlgData.selected.size)||""==G.dlgData.selected.size)&&(console.log("Setting null size"),G.dlgData.selected.size=G.dlgData.brandSizes[0]),console.log("Size:-"+G.dlgData.selected.size);var a=document.getElementById("left_style"),b=document.getElementById("right_style"),c=document.getElementById("left_style_size"),d=document.getElementById("right_style_size");if(console.log("No of fits present:"+G.dlgData.brandStyles.length),console.log("No of style present:"+G.dlgData.brandSizes.length),G.dlgData.brandStyles.length<=2)console.log("Brand Fit Size is 2"),a.style.display="none",b.style.display="none";else if(G.dlgData.brandStyles.length>=3)for(i=0;i<G.dlgData.brandStyles.length;i++)console.log("Style "+i+":-"+G.dlgData.brandStyles[i]),console.log(G.dlgData.selected.style),G.dlgData.selected.style==G.dlgData.brandStyles[i]&&(0==i||1==i?(console.log("At First"),a.style.display="none",b.style.display="block"):i==G.dlgData.brandStyles.length-1?(console.log("At Last"),a.style.display="block",b.style.display="none"):(a.style.display="block",b.style.display="block"));if(G.dlgData.brandSizes.length<=3)console.log("Brand Size is 3"),c.style.display="none",d.style.display="none";else if(G.dlgData.brandSizes.length>=3)for(i=0;i<G.dlgData.brandSizes.length;i++)console.log("Style "+i+":-"+G.dlgData.brandSizes[i]),console.log(G.dlgData.selected.size),G.dlgData.selected.size==G.dlgData.brandSizes[i]&&(0==i||1==i||2==i?(console.log("At First"),c.style.display="none",d.style.display="block"):i==G.dlgData.brandSizes.length-1?(console.log("At Last"),c.style.display="block",d.style.display="none"):(c.style.display="block",d.style.display="block"));G.dlgData.editingProfile?enableButton():(console.log("Not Editing Porfile"),G.dlgData.brandStyles.length>2&&(G.dlgData.selected.style=void 0),G.dlgData.selected.size=void 0,disableButton()),G.dlgData.displayPanel=Z},c.secondpartHeightWeight=function(){console.log("in second"+G.dlgData.selected.shape),G.dlgData.displayPanel=Q,_.isUndefined(G.dlgData.selected.shape)||_.isNull(G.dlgData.selected.shape)||""==G.dlgData.selected.shape?(console.log("In enabaling"),disableButton1()):(console.log("In Disbaling"),enableButton1()),"Hour Glass"==G.dlgData.selected.shape&&k(function(){console.log("yay"),seimaChangeShape(1)},100)},c.showAbout=function(){G.dlgData.displayPanel=V},c.showSignin=function(){G.dlgData.displayPanel=X},c.showrating=function(){o()},c.firstpanel=function(){console.log("smile"),console.log("In first slider :-"+G.data.widget.sizechart.forUser),"Boy"!=G.data.widget.sizechart.forUser&&"Girl"!=G.data.widget.sizechart.forUser||(G.dlgData.selected.htvalue=52,G.dlgData.selected.wtvalue=35,changeSlider()),"2B"!=G.dlgData.displayPanel&&"2B1"!=G.dlgData.displayPanel||(console.log("Going in to brand flow"+G.dlgData.selected.brand),G.dlgData.selected.brand=""),G.dlgData.displayPanel=Y},c.showpanelchart=function(){console.log("in showpanelchart"),G.dlgData.displayPanel=ba},c.try3=function(a,b){var c=document.getElementById("left_style_size"),d=document.getElementById("right_style_size");console.log("In try 3 : "+G.dlgData.brandSizes.length),2==a?(console.log(b),console.log("right pressed"),0==b?(console.log("at start"),c.style.display="none",d.style.display="block"):G.dlgData.brandSizes.length==b+3?(console.log("at end"),c.style.display="block",d.style.display="none"):(console.log("show all"),c.style.display="block",d.style.display="block")):1==a&&(console.log(b),console.log("left pressed"),0==b?(console.log("at start"),c.style.display="none",d.style.display="block"):G.dlgData.brandSizes.length==b+3?(console.log("at end"),c.style.display="block",d.style.display="none"):(console.log("show all"),c.style.display="block",d.style.display="block"))},c.try2=function(a,b){var c=document.getElementById("left_style"),d=document.getElementById("right_style");console.log("In try 2  :"+G.dlgData.brandStyles.length),2==a?(console.log(b),console.log("right pressed"),0==b?(console.log("at start"),c.style.display="none",d.style.display="block"):G.dlgData.brandStyles.length==b+2?(console.log("at end"),c.style.display="block",d.style.display="none"):(console.log("show all"),c.style.display="block",d.style.display="block")):1==a&&(console.log(b),console.log("left pressed"),0==b?(console.log("at start"),c.style.display="none",d.style.display="block"):G.dlgData.brandStyles.length==b+2?(console.log("at end"),c.style.display="block",d.style.display="none"):(console.log("show all"),c.style.display="block",d.style.display="block"))},c.findprogress=function(){console.log("cry"),N=1,c.findFit(),G.dlgData.displayPanel=aa},c.findprogresshtwt=function(){console.log("cry"),N=2,c.findFit1(),G.dlgData.displayPanel=aa},c.clearFunction=function(){console.log("In and on double click funtion"),c.vm.dlgData.selected.brand=""},c.startsWithLetter=function(a){var b=G.dlgData.selected.brand.length;return new RegExp(G.dlgData.selected.brand,"i").test(a.name.substring(0,b))},c.goToSlider=function(){console.log("In go to slider :-"+G.data.widget.sizechart.forUser),"Boy"!=G.data.widget.sizechart.forUser&&"Girl"!=G.data.widget.sizechart.forUser||(G.dlgData.selected.htvalue=52,G.dlgData.selected.wtvalue=35,changeSlider()),"2A"!=G.dlgData.displayPanel&&"2A1"!=G.dlgData.displayPanel||(console.log("Going in to brand flow"+G.dlgData.selected.clothingpfr),G.dlgData.selected.clothingpfr=void 0,disableButton11()),_.isUndefined(G.dlgData.selected.clothingpfr)||_.isNull(G.dlgData.selected.clothingpfr)||""==G.dlgData.selected.shape?(console.log("In enabaling"),disableButton11()):(console.log("In Disbaling"),enableButton11()),G.dlgData.selected.brandName="",G.dlgData.selected.size="",G.dlgData.selected.style="",G.dlgData.displayPanel=P},c.c1Edit=function(a,b){var c=a;console.log("Editing profile : "+JSON.stringify(c)),G.dlgData.selected.profileName=c.profileName,G.dlgData.editingProfile=c,G.dlgData.editingsample=c.samples[0];var d;jQuery.each(c.samples[0],function(a,b){"profileType"==a?G.dlgData.profileType=b:"productType"==a?G.dlgData.selected.clothingType=b:"brandName"==a&&(d=b,r())}),console.log("profilename:"+G.dlgData.profileType),"Guest"!==G.dlgData.selected.profileName||"GUest"!==G.dlgData.selected.profileName||"guest"!==G.dlgData.selected.profileName||"GuesT"!==G.dlgData.selected.profileName?G.dlgData.selected.profileName=G.dlgData.selected.profileName.charAt(0).toUpperCase()+G.dlgData.selected.profileName.substring(1).toLowerCase():G.dlgData.selected.profileName="Guest",console.log("profilename c1Edit:"+G.dlgData.selected.profileName),""==d?(_.isUndefined(G.dlgData.selected.clothingpfr)?disableButton11():enableButton11(),console.log("data.measurementCriteria.height"+JSON.stringify(G.dlgData.editingsample.measurementCriteria.height)),"Boy"==G.data.widget.sizechart.forUser||"Girl"==G.data.widget.sizechart.forUser?(_.isUndefined(G.dlgData.editingsample.measurementCriteria.height)?(console.log("in boy and girl ht"),G.dlgData.selected.htvalue=42,G.dlgData.selected.wtvalue=45):(G.dlgData.selected.htvalue=G.dlgData.editingsample.measurementCriteria.height,G.dlgData.selected.wtvalue=G.dlgData.editingsample.measurementCriteria.weight),changeSlider()):(G.dlgData.selected.htvalue=G.dlgData.editingsample.measurementCriteria.height,G.dlgData.selected.wtvalue=G.dlgData.editingsample.measurementCriteria.weight),console.log("in brand empty"),G.dlgData.fitTab=!0,G.dlgData.ratingTab=!1,G.dlgData.displayPanel=P,G.dlgData.updateProductCriteria=$.map(c.samples,function(a){return a.measurementCriteria}),console.log("updatemeasurement:",G.dlgData.updateProductCriteria[0]),jQuery.each(G.dlgData.updateProductCriteria[0],function(a,b){console.log("value",a),"fitprefer"==a&&(console.log("key fit",b),1==b&&(G.dlgData.selected.clothingpfr="Skin Tight"),2==b&&(console.log("value",b),G.dlgData.selected.clothingpfr="Normal"),3==b&&(G.dlgData.selected.clothingpfr="Bit Loose")),"shape"==a&&(1==b&&(G.dlgData.selected.shape="oval"),2==b&&(G.dlgData.selected.shape="Rectangle"),3==b&&(G.dlgData.selected.shape="Triangle"),4==b&&(G.dlgData.selected.shape="Hour Glass"))}),G.updateMyProfile=1):(console.log("in edit else part",JSON.stringify(c)),console.log("sample",c.samples[0].brandName,c.samples[0].style,c.samples[0].size),G.fromEdit=!0,G.dlgData.displayPanel=Y,G.dlgData.fitTab=!0,G.dlgData.ratingTab=!1,G.dlgData.disableDropDown=!1,G.updateMyProfile=1,k(function(){G.dlgData.selected.brand=c.samples[0].brandName,G.dlgData.selected.styles=c.samples[0].style,G.dlgData.selected.size=c.samples[0].size},1e3))},c.changeSize=function(a){var b=this;console.log("in changeSize");var c=G.data.widget.productRatingDetails.sampleFitting.measurements,d=0,e=G.data.widget.productRatingDetails.scoreDetails[0].overallFitScore;console.log("productDetails:"+JSON.stringify(G.data.widget.productRatingDetails));for(var f=0;f<G.data.widget.productRatingDetails.scoreDetails.length;f++)G.data.widget.productRatingDetails.scoreDetails[f].overallFitScore>e&&(e=G.data.widget.productRatingDetails.scoreDetails[f].overallFitScore,d=f);console.log("selectedBestFit:"+d,a),M=d,G.data.selectedIndex=a,G.dlgData.bestFitScore=e,G.data.score=G.data.widget.productRatingDetails.scoreDetails[a].overallFitScore,G.data.sizes=G.data.widget.productRatingDetails.scoreDetails[a].productSize,G.data.ratings=G.data.widget.productRatingDetails.scoreDetails[a].ratingText,G.data.bestRating=G.data.widget.productRatingDetails.scoreDetails[d].ratingText,G.data.sizes1=G.data.widget.productRatingDetails.scoreDetails[d].productSize,G.data.score1=G.data.widget.productRatingDetails.scoreDetails[d].overallFitScore,console.log("data for rating"+G.data.score,G.data.sizes,G.data.ratings,G.data.bestRating,G.data.sizes1,G.data.score1),console.log("vm.data.ratings"+G.data.ratings,d,a),console.log("good"+G.data.ratings.indexOf("d")),console.log("poor"+G.data.ratings.indexOf("P"));var g=B.replace(/.$/,"?");console.log("str1:"+g),console.log("vm.data.sizes",G.data.sizes);for(var f=0;f<A.length;f++)G.data.sizes==A[f].optiontitle&&(D=A[f].optionvalue);if(console.log("optionValue",D),C=g.concat("super_attribute[134]=",D),console.log("productCartUrl:"+C),G.data.score1<1.5){var h=[];for(var f in G.data.widget.sizechart.productDetails)for(var i in G.data.widget.sizechart.productDetails[f])-1==h.indexOf(i)&&h.push(i);console.log("key:"+h);var j,k={};for(f in h){j=[],0;for(var i in G.data.widget.sizechart.productDetails)G.data.widget.sizechart.productDetails[i][h[f]]&&j.push(G.data.widget.sizechart.productDetails[i].criteria);k["array"+f]=j}var l=k.array0;console.log("new array:"+c,l),console.log("new array length:"+l.length);for(var m=[],n=[],f=0;f<l.length;f++)jQuery.each(l[f],function(a,b){jQuery.each(c,function(c,d){c==a&&("bust"!=c&&"waist"!=c&&"chest"!=c&&"shoulder width"!=c||(m.push(b),n=d))})});console.log("arraynew"+m),console.log("arraynew:"+n);for(var o=parseInt(n),p=0,f=0;f<m.length;f++)p+=parseInt(m[f],10);var q=p/m.length;console.log("The sum of all the elements is: "+p+" The average is: "+q),console.log("vm.data.score:",G.data.score),o<q?(console.log("close fit should be left side"),d=0,G.data.sizes1=G.data.widget.productRatingDetails.scoreDetails[d].productSize,G.data.sizes=G.data.widget.productRatingDetails.scoreDetails[d].productSize,console.log("ratings new:"+G.data.sizes,G.data.score,G.data.ratings,a)):(console.log("close fit should be right side"),d=l.length-1,console.log("selectedBestFit new:"+d),G.data.sizes1=G.data.widget.productRatingDetails.scoreDetails[d].productSize,G.data.sizes=G.data.widget.productRatingDetails.scoreDetails[d].productSize,console.log("vm.data.ratings new:"+G.data.ratings1)),b.demo2=function(){console.log("demo click"),d!==a&&(G.data.sizes=G.data.widget.productRatingDetails.scoreDetails[a].productSize,G.data.ratings="May not fit you")}}G.data.sizes==G.data.sizes1?(3==G.data.bestRating.indexOf("d")&&(console.log("inside good1"+G.data.bestRating),G.data.ratings="Fits Good"),0==G.data.bestRating.indexOf("P")&&G.data.score<1.5&&(console.log("inside poor2"+G.data.bestRating),G.data.ratings="Is closest size"),0==G.data.bestRating.indexOf("P")&&G.data.score>=1.5&&(console.log("inside poor2"+G.data.bestRating),G.data.ratings="Fits Good")):1==G.data.bestRating.indexOf("x")?(console.log("in excellent",G.data.ratings),1==G.data.ratings.indexOf("x")&&(console.log("inside excellent in"),G.data.ratings="Fits Good",G.data.score=2),3==G.data.ratings.indexOf("d")&&(console.log("inside excellent"+G.data.bestRating),G.data.ratings="Fits Good",G.data.score=2),0==G.data.ratings.indexOf("P")&&(console.log("inside good"+G.data.bestRating),G.data.ratings="May not fit you",G.data.score=.5)):3==G.data.bestRating.indexOf("d")?0!=G.data.ratings.indexOf("P")&&3!=G.data.ratings.indexOf("d")||(console.log("inside good"+G.data.bestRating),G.data.ratings="May not fit you",G.data.score=.5):(console.log("inside poor"+G.data.bestRating),G.data.ratings="May not fit you",G.data.score=.5),G.dlgData.uomChanger=G.data.widget.productRatingDetails.sampleFitting.uom},c.selectUom=function(a){console.log("uom trigger",a)},c.findFit=function(){if(console.log("inside find fit",G.dlgData.displayPanel),G.dlgData.error.message="",G.dlgData.displayPanel==S||G.dlgData.displayPanel==Z||G.dlgData.displayPanel==Q||G.dlgData.displayPanel==U){console.log("slider panel if:"+G.dlgData.profileType),null==G.dlgData.selected.profileName||_.isEmpty(G.dlgData.selected.profileName)||_.isUndefined(G.dlgData.selected.profileName)?(1==G.dlgData.profileType&&(G.dlgData.selected.profileName="Guest"),2==G.dlgData.profileType&&(G.dlgData.selected.profileName="guest"),3==G.dlgData.profileType&&(console.log("profileName changed for cal:"+G.dlgData.selected.profileName),G.dlgData.selected.profileName="GUest"),4==G.dlgData.profileType&&(console.log("profileName changed for cal:"+G.dlgData.selected.profileName),G.dlgData.selected.profileName="GuesT")):"Guest"===G.dlgData.selected.profileName&&"guest"===G.dlgData.selected.profileName&&"GuesT"===G.dlgData.selected.profileName&&"GUest"===G.dlgData.selected.profileName||(2==G.dlgData.profileType&&(G.dlgData.selected.profileName=G.dlgData.selected.profileName.toUpperCase(),console.log("profileName:"+G.dlgData.selected.profileName)),3==G.dlgData.profileType&&(G.dlgData.selected.profileName=G.dlgData.selected.profileName.toLowerCase(),console.log("profileName:"+G.dlgData.selected.profileName)),4==G.dlgData.profileType&&(G.dlgData.selected.profileName=G.dlgData.selected.profileName.charAt(0).toUpperCase()+G.dlgData.selected.profileName.slice(1),console.log("profileName:"+G.dlgData.selected.profileName)));var a=G.dlgData.selected,c={profileName:a.profileName,profileType:G.dlgData.profileType,website:G.data.website,brandName:a.brandName,productType:a.clothingType,productSize:a.size,styleName:a.style,updateFlag:G.updateMyProfile,measurementCriteria:{},measurementCriteria1:{}};console.log("fittingdata",c),console.log("Created sample json: "+JSON.stringify(c)),console.log("fittingdata:"+JSON.stringify(c)),w(c),G.sampleModified=!0}else if(_.isUndefined(G.dlgData.listProfile))u();else{var d=jQuery.parseJSON(G.dlgData.listProfile),e={profileName:d.profileName};b.updateData(e,G.data.productCode),u(),G.dlgData.fitTab=!1}},c.findFit1=function(){if(console.log("inside find fit1",G.dlgData.displayPanel),G.dlgData.error.message="",G.dlgData.displayPanel==Q||G.dlgData.displayPanel==U){console.log("slider panel if:"+G.dlgData.profileType),null==G.dlgData.selected.profileName||_.isEmpty(G.dlgData.selected.profileName)||_.isUndefined(G.dlgData.selected.profileName)?(1==G.dlgData.profileType&&(G.dlgData.selected.profileName="Guest"),2==G.dlgData.profileType&&(G.dlgData.selected.profileName="guest"),3==G.dlgData.profileType&&(console.log("profileName changed for cal:"+G.dlgData.selected.profileName),G.dlgData.selected.profileName="GUest"),4==G.dlgData.profileType&&(console.log("profileName changed for cal:"+G.dlgData.selected.profileName),G.dlgData.selected.profileName="GuesT")):"Guest"===G.dlgData.selected.profileName&&"guest"===G.dlgData.selected.profileName&&"GuesT"===G.dlgData.selected.profileName&&"GUest"===G.dlgData.selected.profileName||(2==G.dlgData.profileType&&(G.dlgData.selected.profileName=G.dlgData.selected.profileName.toUpperCase(),console.log("profileName:"+G.dlgData.selected.profileName)),3==G.dlgData.profileType&&(G.dlgData.selected.profileName=G.dlgData.selected.profileName.toLowerCase(),console.log("profileName:"+G.dlgData.selected.profileName)),4==G.dlgData.profileType&&(G.dlgData.selected.profileName=G.dlgData.selected.profileName.charAt(0).toUpperCase()+G.dlgData.selected.profileName.slice(1),console.log("profileName:"+G.dlgData.selected.profileName))),console.log("profilename:",G.dlgData.selected.profileName),console.log("profiletype:",G.dlgData.profileType),console.log("ntvalue new:",E,F);var a=G.dlgData.selected,c={profileName:a.profileName,profileType:G.dlgData.profileType,website:G.data.website,brandName:a.brandName,productType:a.clothingType,productSize:a.size,styleName:a.style,updateFlag:G.updateMyProfile,measurementCriteria:{},measurementCriteria1:{}};if(console.log("vm.data.user.userProfiles:"+JSON.stringify(G.data.user.userProfiles)),_.isEmpty(G.data.user.userProfiles)||(console.log("ntvalue wtvalue:",E,F),_.isUndefined(E)&&(console.log("inside ht undefine"),E=G.data.user.userProfiles[0].samples[0].measurementCriteria.height),_.isUndefined(F)&&(console.log("inside wt undefine"),F=G.data.user.userProfiles[0].samples[0].measurementCriteria.weight),_.isUndefined(z)&&(console.log("inside fitno undefine"),z=G.data.user.userProfiles[0].samples[0].measurementCriteria.fitprefer),null==z&&(console.log("fintno null"),z=2),null==y&&(console.log("shape no null"),y=2)),console.log("fittingdata",c),console.log("profiletype:"),G.dlgData.displayPanel==Q){if(console.log("inside findfit1 change range",G.dlgData.uomProductCriteriah),"cm"==G.dlgData.uomProductCriteriah){console.log("inside height conversion");var d=Math.round(E/2.54);E=d}if(console.log("aferconversion:"+E),"lb"==G.dlgData.uomProductCriteriaw){console.log("inside weight conversion");var e=Math.round(F/2.2);F=e}console.log("aferconversion:"+F),null==G.dlgData.selected.clothingpfr&&(G.dlgData.selected.clothingpfr="Normal Fit"),console.log("shape number",y),c.measurementCriteria1=[y,E,F,z],console.log("measurementCriteria1",E,F)}console.log("Created sample json: "+JSON.stringify(c)),s(c),console.log("fittingdata:"+JSON.stringify(c)),w(c),G.sampleModified=!0}else if(_.isUndefined(G.dlgData.listProfile))u();else{var f=jQuery.parseJSON(G.dlgData.listProfile),g={profileName:f.profileName};b.updateData(g,G.data.productCode),u(),G.dlgData.fitTab=!1}},c.closePopUp=function(){!G.signedIN&&G.sampleModified&&f.host()==h.name?(G.dlgData.disableProfile=!1,G.dlgData.fitTab=!0,G.dlgData.displayPanel=7):(console.log("in else"),a.close(),x())},c.closeWindow=function(){a.close(),x()}}]}),b.getTechSpecList(d).success(function(a,d){console.log("prodId"+a.data.techSpecList[0].productIdentifierId),console.log("techSpecList"+JSON.stringify(a.data.techSpecList)),b.getTechSpecDetail(a.data.techSpecList[0].productIdentifierId).success(function(a,b){a.data.productDetails,a.data.criteriaSequence;G.data.widget.sizechart=a.data,console.log("optionsize:",JSON.stringify(G.data.widget.sizechart.productDetails)),G.data.criteriadata=a.data.criteriaSequence}).error(function(a,b){console.log("error TechSpec Detail function: data: "+JSON.stringify(a)+" ;status: "+b),c.error=!0,c.errorMessages=a.errors})}).error(function(a,b){console.log("TechSpec List Function: error function: data: "+JSON.stringify(d)+" ;status: "+b),c.error=!0,c.errorMessages=d.errors})}function r(){b.getBrandStyles(G.dlgData.profileType,G.dlgData.selected.clothingType).success(function(a,b){console.log("get brand style"),H=a,"success"==a.status?(console.log("all brands",a.data.brands),K=a.data.brands,G.dlgData.brands=K,G.dlgData.editingProfile&&3==G.data.widgetDisplayStatus&&c.$broadcast("editingSample",G.dlgData.editingsample)):console.log("fmfWidgetDialog: getBrandStyles error function: errors: "+a.errors)}).error(function(a,b){console.log("fmfWidgetDialog: getBrandStyles error function: data: "+JSON.stringify(a)+" ;status: "+b)})}function s(a){console.log("inside ht wt function"),console.log("Saving sample: "+JSON.stringify(a)),b.getHeightWeight(a).success(function(b,c){console.log("fmfWidgetDialog: saveheightWeightSample data: "+JSON.stringify(b)+"  ;status: "+c),"success"==b.status&&(a.measurementCriteria=b.data.sizeListArray,console.log("fittingData.measurementCriteria"+JSON.stringify(a.measurementCriteria)),w(a),console.log("getHeightWeight:"+a))}).error(function(a,b){console.log("sizeListArray"+a.data),_.isUndefined(a.data)&&(console.log("is isUndefined"+_.isUndefined(a.data)),G.dlgData.error.message="Unable to find your reference combination try brand reference.",console.log("error:",G.dlgData.error.message))})}function t(a,c,d,e,f,g,h){b.getWidgetStatus(a,c,d,e,f,g,h).success(function(a,d){console.log("fmfWidgetDialog: widgetStatus function data: "+JSON.stringify(a)+"  ;status: "+d),console.log("widgetstatus",a.data.widgetStatus.code),console.log("details required",c),"success"==a.status?(G.data.widgetDisplayStatus=a.data.widgetStatus.code,G.data.productRatingDetails=a.data.widgetStatus.data,G.data.widgetDisplayStatus==b.statusConstants().LINKDISPLAYED?(G.data.enterpriseProductType=a.data.widgetStatus.data.current.productType,G.data.enterpriseProfileType=a.data.widgetStatus.data.current.profileType,b.saveWidgetSelection(G.data.enterpriseProfileType,G.data.enterpriseProductType,G.data.productCode)):(console.log("in status and 5"),G.data.enterpriseProfileType=a.data.widgetStatus.data.sampleFitting.profileType,G.data.enterpriseProductType=a.data.widgetStatus.data.sampleFitting.productType,b.saveWidgetSelection(G.data.enterpriseProfileType,G.data.enterpriseProductType,G.data.productCode)),p(),b.updateWidgetData(a.data.widgetStatus.code,a.data.widgetStatus.data,G.data.productCode),G.data=b.getData(G.data.productCode)):(console.log("fmfWidgetDialog: getWidgetStatus error function: errors: "+JSON.stringify(a.errors)),G.dlgData.error.message=JSON.stringify(a.errors))}).error(function(a,b){console.log("fmfWidgetDialog: getWidgetStatus error function: data: "+JSON.stringify(a)+" ;status: "+b),G.dlgData.error.message=JSON.stringify(a.errors)})}function u(){console.log("in getrating data"),G.dlgData.error.message="",t(G.data.productCode,1,G.data.widget.productImageUrl,G.data.widget.productPrice,G.data.widget.productDescription,G.data.widget.enterpriseCurrency,G.data.widget.productCartSize)}function v(){console.log("fmfWidgetDialog: getting user profiles..."),b.getUserProfiles().success(function(a,b){console.log("fmfWidgetDialog: getUserProfiles data: "+JSON.stringify(a)+"  ;status: "+b),"success"==a.status?(console.log(a.data.profiles),G.data.user.userProfiles=a.data.profiles):console.log("fmfWidgetDialog: getUserProfiles error function: errors: "+JSON.stringify(a.errors))}).error(function(a,b){})}function w(a){console.log("Saving sample: "+JSON.stringify(a)),b.saveFittingSample(a).success(function(a,c){if(console.log("fmfWidgetDialog: saveFittingSample data: "+JSON.stringify(a)+"  ;status: "+c),"success"==a.status){console.log("savefitting");var d={profileName:G.dlgData.selected.profileName};b.updateData(d,G.data.productCode),u(),v(),G.dlgData.fitTab=!1,G.dlgData.ratingTab=!0,G.dlgData.showScoreDetails=!0}else console.log("fmfWidgetDialog: error saveFittingSample: "+JSON.stringify(a.errors)),G.dlgData.displayPanel==W?G.dlgData.displayPanel=Y:G.dlgData.displayPanel=R,G.dlgData.error.message=JSON.stringify(a.errors)}).error(function(a,b){console.log("fmfWidgetDialog: error saveFittingSample: "+JSON.stringify(a)+" ;status: "+b),G.dlgData.displayPanel==W?G.dlgData.displayPanel=Y:G.dlgData.displayPanel=R,G.dlgData.error.message="Unable to save sample fitting. Please try again."})}function x(){console.log("closed"),G.dlgData.error.message="",b.reloadWidgetsRatingData(G.sampleModified,G.data.productCode)}console.log("fmfWidgetDialog: controller called");var y,z,A,B,C,D,E,F,G=this,H={},I={},J=[],K=[],L=0,M=0,N=0,O=0,P="2B",Q="2B1",R=5,S=0,T=11,U=12,V=8,W=1,X=7,Y="2A",Z="2A1",aa=13,ba=10;g.url;G.fmfManager={},G.data={},G.dlgData={error:{},displayPanel:0,profileType:1,productTypes:{},selected:{criteria:{},clothingType:""}},G.dlgData.AWS_WIDGET_IMAGES_CLOUD_FRONT_URL=g.url,G.customDriven=!1,G.updateMyProfile=0,G.fromEdit=!1,G.dlgData.disableProfile=!1,G.dlgData.disableName=!1,G.sampleModified=!1,G.signedIN=!1,G.dlgData.loginTab=!1,G.initialize=l,c.loadOptions=function(){console.log("$scope.categories"),angular.element(document.querySelector("#list")).click()}}]}}]),angular.module("fmf.widgets").directive("fmfWidget",function(){return{restrict:"AE",require:["^fmfWidgetManager","fmfWidget"],controllerAs:"vm",scope:{},templateUrl:"https://rawgit.com/snfpratiksha/sizenfitmagentotry/master/fmfWidgetTemplate.html",link:function(a,b,c,d){var e=d[0],f=d[1];f.fmfManager=e,f.initialize()},controller:["$scope",function(a){function b(){e.widgetData=e.fmfManager.getData(),a.deriveDisplayStar=function(a){for(var b=[],c=a,d=0;d<f;d++)b[d]=c>=1?1:c>0?.5:0,c-=1;return b},h(),a.changeSize=function(a){_.isUndefined(e.widgetData.widget)||_.isUndefined(e.widgetData.widget.fullDetails)||(e.widgetData.selected=e.widgetData.widget.fullDetails[a])}}function c(){e.fmfManager.showDialog()}function d(){e.fmfManager.showSizechart()}var e=this,f=5;e.fmfManager={},e.widgetData={},e.initialize=b,e.invokeDialog=c,e.sizechart=d;var g,h=function(){g=a.$on("refreshWidget",function(a,b,c){b==e.widgetData.productCode&&(e.fmfManager.initialize(c),e.widgetData=e.fmfManager.getData())})};a.$watch("vm.widgetData.widget",function(a){_.isUndefined(a)&&(e.widgetData=e.fmfManager.getData())}),a.$on("changeSize",function(a,b,c){if(c==e.widgetData.productCode)for(var d=0;d<e.widgetData.widget.fullDetails.length;d++)e.widgetData.widget.fullDetails[d].productSize===b&&(e.widgetData.selected=e.widgetData.widget.fullDetails[d])}),a.$watch("vm.widgetData.widget.fullDetails",function(a){var b=0,c=0;if(!_.isUndefined(e.widgetData.widget)&&!_.isUndefined(e.widgetData.widget.fullDetails)){for(var d=0;d<e.widgetData.widget.fullDetails.length;d++)e.widgetData.widget.fullDetails[d].overallFitScore>b&&(b=e.widgetData.widget.fullDetails[d].overallFitScore,c=d);e.widgetData.selected=e.widgetData.widget.fullDetails[c],console.log("widget all"+JSON.stringify(e.widgetData.widget.productRatingDetails.sampleFitting.measurements));var f=e.widgetData.widget.productRatingDetails.sampleFitting.measurements;if(e.widgetData.widget.bestFit.ratingScore<1.5){var g=[];for(var d in e.widgetData.widget.sizechart.productDetails)for(var h in e.widgetData.widget.sizechart.productDetails[d])-1==g.indexOf(h)&&g.push(h);console.log("key:"+g);var i,j={};for(d in g){i=[],0;for(var h in e.widgetData.widget.sizechart.productDetails)e.widgetData.widget.sizechart.productDetails[h][g[d]]&&i.push(e.widgetData.widget.sizechart.productDetails[h].criteria);j["array"+d]=i}var k=j.array0;console.log("new array:"+f,k),console.log("new array length:"+k.length);for(var l=[],m=[],d=0;d<k.length;d++)$.each(k[d],function(a,b){$.each(f,function(c,d){c==a&&("bust"!=c&&"waist"!=c&&"chest"!=c&&"shoulder width"!=c||(l.push(b),m=d))})});console.log("arraynew"+l),console.log("arraynew:"+m);for(var n=parseInt(m),o=0,d=0;d<l.length;d++)o+=parseInt(l[d],10);var p=o/l.length;console.log("The sum of all the elements is: "+o+" The average is: "+p),console.log("fmfwidget bestfit:",e.widgetData.widget.bestFit);var q;console.log("fmfwidget newlen:"+JSON.stringify(e.widgetData.widget.fullDetails)),n<p?(console.log("close fit should be left side"),q=0,console.log("fmfwidget:"+e.widgetData.widget.fullDetails),e.widgetData.widget.bestFit.size=e.widgetData.widget.fullDetails[q].productSize,console.log("fmfwidget ratings new:"+e.widgetData.widget.bestFit.size)):(console.log("close fit should be right side"),q=k.length-1,console.log("fmfwidget selectedBestFit:"+q),e.widgetData.widget.bestFit.size=e.widgetData.widget.fullDetails[q].productSize,console.log("fmfwidget rating final size:"+e.widgetData.widget.bestFit.size))}}})}]}}); 
